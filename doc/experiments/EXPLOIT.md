# Instructions for an Exploit Experiment

The goal of a typical exploit experiment is to demonstrate that ZenIDS raises an alert during execution of the exploit, but does not raise alerts during normal usage of the vulnerable application. The false positive aspect of the experiment can be done just like the general [FP/FN experiment](https://github.com/uci-plrg/zen-ids/blob/interp-opt/doc/experiments/ACCURACY.md), although it may not be convenient to use live HTTP traffic, since it is not easy to draw visitors to any random application you might happen to install. Identifying the exploit is a simple matter of running the POC and verifying that ZenIDS raises the expected intrusion alert.

Since this experiment is fairly self-explanatory, the overview is simply repeated here:

1. Pick your favorite exploit
  * We recommend [exploit-db.com](http://exploit-db.com)
  * ZenIDS can only detect exploits that manipulate control flow at the script level. This excludes:
    * Data-only attacks such as conventional XSS and SQLi
    * Attacks on the native code of the interpreter
2. Install the vulnerable PHP application in the Apache instance where ZenIDS is installed.
3. Verify the exploit by running the POC.
4. Create a *trusted profile* for the application
  * Crawl it with `wget`
  * Access the application in a browser, using a variety of features in ways that appear normal
  * Create and deploy the resulting profile
5. Test the vulnerability scenario:
  * Continue to use and crawl the application, counting the number of false alerts (if any)
  * Run the POC and verify the expected alert
